generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_DATABASE_URL")
}

enum DeathMessageStatus {
  pending
  success
  processing
  error
}

model DeathMessage {
  id               String             @id @default(uuid()) @db.Uuid
  routingKey       String             @map("routing_key")
  reason           String
  exchange         String
  traceId          String?            @map("trace_id")
  iv               String
  authTag          String             @map("auth_tag")
  encryptedContent String             @map("encrypted_content")
  status           DeathMessageStatus @default(pending)
  successAt        DateTime?          @map("success_at")
  serviceName      String             @map("service_name")
  createdAt        DateTime           @default(now()) @map("created_at")
  updatedAt        DateTime           @default(now()) @updatedAt @map("updated_at")

  @@index([createdAt(sort: Desc)])
  @@map("death_messages")
}
